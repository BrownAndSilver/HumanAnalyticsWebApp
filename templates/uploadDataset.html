<!DOCTYPE html>
<html lang="en">
{% extends "base.html" %}
{% block content %}
<head>
    <title>Upload/View Excel</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
</head>

<style>
  .dataset-list-quote {
    width: 400px;
    height: 300px;
    border: 1px solid;
    overflow: scroll;
    scrollbar-color: grey white;
    scrollbar-width: thin;
  }

  .dataset-file {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 5px;
  }

  .file-name {
    flex: 1;
  }

  .delete-btn {
    margin-left: 10px;
  }

  .container {
    display: flex;
  }

  .form-container {
    flex: 1;
  }

  .dataset-list {
    flex: 1;
    margin-left: 20px;
  }
</style>

<body>
    <h1>Upload Excel File (.xlsx)</h1>
    <div class="container">
        <div class="form-container">
            <form action="/uploadDataset" method="post" enctype="multipart/form-data">
                <input type="file" name="file"
                accept="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel">
            <br>
            <br>
            <input type="submit" value="Upload" style="height:50px; width:100px">
            </form>
        </div>

        <div class="dataset-list">
            <h1>All Datasets</h1>
            <blockquote class="dataset-list-quote">
            {% for file in dataset_files %}
                {% if file != "current.csv" %}
                <div class="dataset-file">
                    <span class="file-name">{{ file }}</span>
                    <button class="select-btn" onclick="selectDataset('{{ file }}')">Select Dataset</button>
                    <button class="delete-btn" onclick="deleteFile('{{ file }}')">Delete</button>
                </div>
                {% endif %}
            {% endfor %}
            </blockquote>
        </div>
    </div>

    <script>
<!--Function for deleting datasets-->
        function deleteFile(filename) {
            $.ajax({
                url: '/deleteDataset',
                type: 'POST',
                contentType: 'application/json',
                data: JSON.stringify({ filename: filename }),
                success: function(response) {
                    if (response.success) {
                        alert('File deleted successfully');
                        location.reload();
                    } else {
                        alert('Error deleting file: ' + response.error);
                    }
                }
            });
        }


<!-- Function for selecting which dataset to use --!>
function selectDataset(filename) {
    $.ajax({
        url: '/selectDataset/' + filename,
        type: 'GET',
        success: function(response) {
            if (response.success) {
                alert('Dataset selected successfully: ' + response.filename);
                // Update the content of current.csv
                $('#current-dataset').text(response.filename);
                        location.reload();
            } else {
                alert('Error selecting dataset: ' + response.error);
            }
        }
    });
}

    </script>

</body>
{% endblock %}
</html>